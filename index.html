<!DOCTYPE html>
<html>
<head>
<title>Test 7 20231011</title>
<script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
<script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar-threex-location-only.js'></script>
<script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js'></script>
</head>

  <body style="margin: 0; overflow: hidden;">

	<!-- Rotation Reader Script Component for Camera, called in a-camera -->
	<script>
	AFRAME.registerComponent('rotation-reader', {
  /**
   * We use IIFE (immediately-invoked function expression) to only allocate one
   * vector or euler and not re-create on every tick to save memory.
   */
  tick: (function () {
    var position = new THREE.Vector3();
    var quaternion = new THREE.Quaternion();

    return function () {
      this.el.object3D.getWorldPosition(position);
      this.el.object3D.getWorldQuaternion(quaternion);
      // position and rotation now contain vector and quaternion in world space.
    };
  })()
});
	</script>

<script>
AFRAME.registerComponent("fov-change", {
        init: function () {
          // grab the camera
          const cam = document.querySelector("[camera]");
          // this.el should also work for this as long as your fov-change component is on the camera
          // grab the current FOV, this will be 80 as that's the default for aframe
          const fov = cam.getAttribute("camera").fov;
          console.log("Wow, fov is ", fov);
          // update the camera with the new FOV
          // if holding portrait use 61:
          // cam.setAttribute("camera", "fov", 61)

          // For whatever weird reason it seems that chrome and firefox use different fov values?
          if (navigator.userAgent.indexOf("Chrome") != -1) {
            cam.setAttribute("camera", "fov", 87);
          } else if (navigator.userAgent.indexOf("Firefox") != -1) {
            // For landscape, 45 on the ipad, 52.75 for the samsung
            cam.setAttribute("camera", "fov", 52.75);
          } else {
            // Don't really know what other browsers use, but most will be chromium I suppose?
            cam.setAttribute("camera", "fov", 87);
          }

          console.log("Wow, fov is now", document.querySelector("[camera]").getAttribute("camera").fov);
        },
      });
</script>

	<a-scene 
	  vr-mode-ui='enabled: false' 
	  arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: false' 	
	  renderer='antialias: true; alpha: true'>

        <!-- Camera -->
   	 <a-camera fov-change id="camera1" gps-new-camera='gpsMinDistance: 5' rotation-reader></a-camera>

        <!-- Geolocation entity -->
   	 <a-entity id="textclue"
	  gps-new-entity-place="latitude: -34.994176843135364; longitude: 138.62641997298257;" 
	  scale="150 150 150" 
	  look-at="camera1">
		<!-- Text object with line breaks -->
		<a-text 
		  value="Amidst the greenery, a Victorian grace,\nA glassy gem, a tropical embrace." 
		  position="0 0 -1" 
		  color="black" 
		  align="center" 
		  scale="0.5 0.5 0.5"  
		  wrap-count="15">
		</a-text>

		<!-- Create a box for the text -->
		<a-box 
		  position="0 0 -1.3" 
		  width="3" height="2" depth="0.1" 
		  color="white">
		</a-box>

	 </a-entity>
	</a-scene>
</body>
</html>
